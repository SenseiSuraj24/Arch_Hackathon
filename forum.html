<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Forum - Quora Style</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: #fff; }
    body { background-color: #121212; line-height: 1.5; font-size: 14px; }
    .topbar { background-color: #1e1e1e; display: flex; align-items: center; justify-content: space-between; padding: 0 1rem; height: 60px; border-bottom: 1px solid #333; }
    .logo img { height: 40px; width: auto; }
    .navlinks { display: flex; align-items: center; gap: 20px; }
    .navlinks a { color: #bbb; text-decoration: none; font-weight: 600; transition: color 0.3s; }
    .navlinks a:hover { color: #60a5fa; }
    .container { display: flex; height: calc(100vh - 60px); }
    .sidebar { background-color: #1f2937; width: 220px; padding: 20px; display: flex; flex-direction: column; gap: 15px; border-right: 1px solid #374151; }
    .sidebar h2 { font-size: 20px; margin-bottom: 10px; font-weight: 700; color: #e2e8f0; }
    .nav-link { padding: 10px 15px; color: #bbb; text-decoration: none; font-weight: 600; border-radius: 6px; display: block; transition: background-color 0.3s, color 0.3s; }
    .nav-link:hover { background-color: #2563eb; color: white; }
    .main-content { flex-grow: 1; background-color: #0f172a; padding: 20px 30px; overflow-y: auto; display: flex; flex-direction: column; }
    .dashboard-bar { display: flex; gap: 20px; margin-bottom: 25px; }
    .dashboard-card { background-color: #1e293b; flex: 1; padding: 20px; border-radius: 10px; text-align: center; box-shadow: 0 2px 5px rgba(0,0,0,0.5); }
    .dashboard-card h3 { font-size: 28px; font-weight: 700; color: #60a5fa; margin-bottom: 5px; }
    .dashboard-card p { font-weight: 600; color: #bbb; }
    .forum-title { font-size: 28px; font-weight: 700; margin-bottom: 25px; color: #e2e8f0; }
    .forum-list { display: flex; flex-direction: column; gap: 16px; margin-bottom: 30px; }
    .forum-card { background-color: #1e293b; padding: 18px 22px; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.4); cursor: pointer; transition: background-color 0.2s; }
    .forum-card:hover { background-color: #2563eb; }
    .forum-card h4 { font-weight: 700; font-size: 18px; margin-bottom: 10px; color: white; }
    .forum-info { font-size: 12px; color: #a1a1aa; font-weight: 500; }
    .forum-status { font-weight: 600; padding: 1px 8px; border-radius: 12px; font-size: 11px; margin-left: 8px; }
    .status-answered { background-color: #22c55e; color: white; }
    .status-pending { background-color: #facc15; color: black; }
    .ask-form { background-color: #1e293b; padding: 20px; border-radius: 10px; max-width: 800px; display: flex; flex-direction: column; gap: 15px; }
    .ask-form label { font-weight: 600; color: #e0e7ff; font-size: 14px; }
    .ask-form input[type="text"], .ask-form textarea { background-color: #111827; border: none; padding: 12px; border-radius: 8px; color: #d1d5db; font-size: 14px; }
    .ask-form button { background-color: #2563eb; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 700; font-size: 14px; cursor: pointer; }
    .small-muted { color:#9ca3af; font-size:12px; }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="logo"><img src="vital-link-logo.png" alt="Logo"></div>
    <nav class="navlinks"><a href="patient-dashboard.html">Patient Dashboard</a></nav>
  </div>

  <div class="container">
    <aside class="sidebar">
      <h2>FORUM</h2>
      <a href="patient-dashboard.html" class="nav-link">Dashboard</a>
      <a href="update-profile.html" class="nav-link">Profile</a>
    </aside>

    <main class="main-content">
      <div class="dashboard-bar" id="dashboardBar">
        <div class="dashboard-card"><h3 id="totalQ">0</h3><p>Questions</p></div>
        <div class="dashboard-card"><h3 id="unansweredQ">0</h3><p>Unanswered</p></div>
        <div class="dashboard-card"><h3 id="answersGiven">0</h3><p>Answers Given</p></div>
        <div class="dashboard-card"><h3 id="messages">0</h3><p>Messages</p></div>
      </div>

      <div class="forum-title">Forum - Ask & Answer</div>
      <section class="forum-list" id="forumList">
        <!-- dynamically populated -->
      </section>

      <form class="ask-form" onsubmit="submitQuestion(event)">
        <label for="askq">Ask a Question</label>
        <input id="askq" type="text" placeholder="Type your question here..." required />
        <label for="qdesc">Description (optional)</label>
        <textarea id="qdesc" rows="3" placeholder="Add more details to your question..."></textarea>
        <button type="submit">Submit</button>
      </form>
    </main>
  </div>

  <script>
    const STORAGE_KEY = 'forum_local_data_v1';

    function defaultData() {
      return [
        {
          id: '1',
          title: 'I have back pain from a previous injury from an accident, which doctor would you suggest?',
          description: '',
          author: 'Venkat V',
          date: 'Oct 18, 2025',
          answers: [
            { id: 'a1', text: 'See an orthopaedic surgeon or spine specialist. Get imaging done first.', author: 'Dr. A', date: 'Oct 18, 2025' },
            { id: 'a2', text: 'Start with physiotherapy and pain management.', author: 'Therapist', date: 'Oct 18, 2025' },
            { id: 'a3', text: 'If nerve symptoms, consult a neurologist.', author: 'Dr. B', date: 'Oct 19, 2025' }
          ]
        },
        {
          id: '2',
          title: "I need a respiratory specialist for my son's asthma",
          description: '',
          author: 'Veer G',
          date: 'Oct 18, 2025',
          answers: [
            { id: 'a4', text: 'A paediatric pulmonologist is best for children with asthma.', author: 'Dr. C', date: 'Oct 18, 2025' }
          ]
        },
        {
          id: '3',
          title: 'Who should I go to for a knee surgery?',
          description: '',
          author: 'Carol',
          date: 'Oct 17, 2025',
          answers: []
        }
      ];
    }

    function loadData() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) {
        const d = defaultData();
        localStorage.setItem(STORAGE_KEY, JSON.stringify(d));
        return d;
      }
      try {
        return JSON.parse(raw);
      } catch (e) {
        const d = defaultData();
        localStorage.setItem(STORAGE_KEY, JSON.stringify(d));
        return d;
      }
    }

    function saveData(arr) {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
    }

    function renderDashboard(questions) {
      const total = questions.length;
      const unanswered = questions.filter(q => q.answers.length === 0).length;
      const answersGiven = questions.reduce((s, q) => s + q.answers.length, 0);
      document.getElementById('totalQ').textContent = total;
      document.getElementById('unansweredQ').textContent = unanswered;
      document.getElementById('answersGiven').textContent = answersGiven;
      document.getElementById('messages').textContent = 0;
    }

    function renderList() {
      const listEl = document.getElementById('forumList');
      const questions = loadData();
      renderDashboard(questions);
      listEl.innerHTML = '';
      questions.slice().reverse().forEach(q => {
        const div = document.createElement('div');
        div.className = 'forum-card';
        div.onclick = () => location.href = `question.html?id=${encodeURIComponent(q.id)}`;
        const h = document.createElement('h4');
        h.textContent = q.title;
        const info = document.createElement('div');
        info.className = 'forum-info';
        const statusSpan = document.createElement('span');
        statusSpan.className = 'forum-status ' + (q.answers.length ? 'status-answered' : 'status-pending');
        statusSpan.textContent = q.answers.length ? 'Answered' : 'Pending';
        info.innerHTML = `By ${q.author} â€” ${q.date} | `;
        info.appendChild(statusSpan);
        info.insertAdjacentText('beforeend', ` ${q.answers.length} Answer${q.answers.length !== 1 ? 's' : ''}`);
        div.appendChild(h);
        div.appendChild(info);
        listEl.appendChild(div);
      });
    }

    function submitQuestion(event) {
      event.preventDefault();
      const title = document.getElementById('askq').value.trim();
      const desc = document.getElementById('qdesc').value.trim();
      if (!title) return;
      const questions = loadData();
      const newQ = {
        id: String(Date.now()),
        title,
        description: desc,
        author: 'You',
        date: new Date().toLocaleDateString(),
        answers: []
      };
      questions.push(newQ);
      saveData(questions);
      document.getElementById('askq').value = '';
      document.getElementById('qdesc').value = '';
      renderList();
    }

    document.addEventListener('DOMContentLoaded', renderList);
  </script>
</body>
</html>
